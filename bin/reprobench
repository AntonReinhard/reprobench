#!/usr/bin/env python

import argparse
import logging
import sys
import yaml

from reprobench.utils import import_class

if __name__ == "__main__":
    parser = argparse.ArgumentParser(
        description="Run a benchmark based on configuration."
    )
    parser.add_argument("--runner", default="reprobench.runners.LocalRunner")
    parser.add_argument(
        "-v", "--verbose", help="Increase output verbosity", action="store_true"
    )
    parser.add_argument(
        "-d", "--debug", help="Print lots of debugging messages", action="store_true"
    )
    parser.add_argument("config", type=open)
    args = parser.parse_args()

    if args.verbose:
        logging.basicConfig(level=logging.INFO)
    elif args.debug:
        logging.basicConfig(level=logging.DEBUG)

    config = yaml.load(args.config)
    Executor = import_class(args.runner)
    executor = Executor(config)
    executor.run()

