title: MC2021
description: Benchmark for mergesat experiments (norbert)

limits:
  time: 300 # s
#  time: 3600
  memory: 8048 # mb
  scheduler_memory: 32768 #mb

steps:
  run:
# move to step that runs once on a node, but not every time; there is no point in collecting the data every time
    - module: reprobench.core.sysinfo.CollectSystemInfo4Server
    - module: reprobench.core.setup.SetupKernel
      config:
#        transparent_hugepage: madvise
        # see: https://www.kernel.org/doc/html/v4.12/admin-guide/pm/intel_pstate.html
        governors: 2.8Ghz
    # TODO: performance govenors / --cpu-freq srun
    - module: reprobench.executors.RunSolverPerfEval
    # provide non-perf runner
    # provide configurable perf parameters
#    - module: reprobench.executors.PsmonExecutor
      config:
        nonzero_rte: False

observers:
  - module: reprobench.core.sysinfo.SystemInfoObserver
#  - module: reprobench.executors.RunStatisticObserver
  - module: reprobench.executors.RunStatisticExtendedObserver

#  analysis:
#    - module: reprobench.statistics.tables.RunTable
#      config:
#        joins:
#          - reprobench.executors.db.RunStatistic
#          - reprobench.core.sysinfo.RunNode
#        output: statistics/raw.csv
#    - module: reprobench.statistics.tables.RunSummaryTable
#      config:
#        output: statistics/summary.csv
#    - module: reprobench.statistics.plots.CactusPlot
#      config:
#        measure: wall_time
#        output: statistics/cactus.ipynb

tasks:
  track1:
    type: file
    path: /projects/p_mcc2020/track1/benchmarks/
    extract_archives: true
    patterns: |
      **/*
      !**/*.tar.bz2
      !**/*.tar.xz
      !**/*.tar.gz
      !**/*.tgz
      !**/.*
      !**.*~
      !**/mcc2020_pcnf
      !**/*.txt
      !**/*.md
      !**/*.smt
      !**/*.pdf
      !**/*.processed
#      **/*
#      TT7F-34-25.cnf.xz

tools:
  mc2021:
    module: experiment.mc2021.executor.PrefExec
    parameters:
        bash:
          cmd: "/projects/p_mcc2020/track1/bin/solver_binaries/{solver}.sh {filename}"
          solver:
            - d4
        py:
          cmd: "/projects/p_mcc2020/track1/bin/solver_binaries/{solver}.py {filename}"
          solver:
            - c2d

runs:
  mc2021:
    all:
      - track1
