title: THP
description: Benchmark for different runtimes with and without glibc hack

limits:
  time: 20 # s
  memory: 8048 # mb
  scheduler_memory: 32768 #mb

steps:
  run:
    - module: reprobench.core.sysinfo.CollectSystemInfo4Server
    - module: reprobench.core.setup.SetupKernel
      config:
        transparent_hugepage: madvise
    # TODO: performance govenors / --cpu-freq srun
    - module: reprobench.executors.RunSolverPerfEval
    # provide non-perf runner
    # provide configurable perf parameters
#    - module: reprobench.executors.PsmonExecutor
      config:
        nonzero_rte: False

observers:
  - module: reprobench.core.sysinfo.SystemInfoObserver
#  - module: reprobench.executors.RunStatisticObserver
  - module: reprobench.executors.RunStatisticExtendedObserver

#  analysis:
#    - module: reprobench.statistics.tables.RunTable
#      config:
#        joins:
#          - reprobench.executors.db.RunStatistic
#          - reprobench.core.sysinfo.RunNode
#        output: statistics/raw.csv
#    - module: reprobench.statistics.tables.RunSummaryTable
#      config:
#        output: statistics/summary.csv
#    - module: reprobench.statistics.plots.CactusPlot
#      config:
#        measure: wall_time
#        output: statistics/cactus.ipynb

tasks:
  dfremont:
      type: file
      urls:
        - https://github.com/dfremont/counting-benchmarks.git
      path: /projects/p_gpusat/automated-reasoner-builds/benchmarks/mc
      extract_archives: false
      patterns: |
        **/*.gz
        !**/*.tar.bz2
        !**/*.tar.xz
        !**/*.tar.gz
        !**/*.tgz
        !**/.*
        !**.*~
#

tools:
  mc_pre:
    module: experiment.thp.tool.wmc.wmcPreExecutor.WMCPreprocessor
    parameters:
      #name of parameter configuration: we may have multiple ones
      default:
        p:
          - b+e
          - pmc
          - pmcstar
        t:
          - 0

runs:
  mc_pre:
    all:
      - dfremont
